<html>
    <head>
        <script type="text/javascript" src="bin/ejs.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.16/d3.js"></script>
        <script>
        //console.log("hello");
            var doc = new ejs.xml.XmlDocument();
            doc.root = new ejs.xml.XmlNode('a:aria', [{name : 'help', value : 'never another'}]);
            var node = new ejs.xml.XmlNode('help', [{name : 'haha', value : 'sure'}]);
            doc.root.nodes.push(node);
            
            //console.log(doc);
            
            //console.log(doc.write({pretty: true}), doc.toBinary());
            
            //var workbook = new ejs.xl.Workbook();
            
            //console.log(workbook.writeXml());
            
            var test = 'abbabbaaabababaaaaabbabaa';
            //var test = "Blahblahblahblahblahblahblah";
            test = 'Of the night, it is well. What is good of the night? Night brings with it the covering darkness that veils all and hinders our sight.';
            
            var lz = new ejs.zip.LZ77();
            //var lzw = new ejs.zip.LZW();
            //console.log('input', test);
            //console.log('output', lz.compress(test));
            
            var data = new ArrayBuffer(8);
            var view = new Uint8Array(data);
            view[0] = 255;
            view[1] = 150;
            view[2] = 255;
            
            //ejs.helper.saveText('Never.txt', 'This is what happens');
            
            window.onload = function(){
                var huff = new ejs.zip.Huffman();
                huff.encode(test);
                var op = d3.select('#output');
                var codeElements = op.selectAll('div.codes').data(huff.codes);
                codeElements.enter().append('div').attr('class', 'codes');
                
                //console.log(huff);
                codeElements.text(function(d){
                    return d.code + ' - ' + d.bs + ' - ' + d.next;
                });
            }
            
            var buffer = new ejs.zip.BitStream();
                                    
            //buffer.writeByte(ejs.zip.FILE_HEADER, 4, true);
            
            //console.log(buffer);
            //buffer.flush();
            //buffer.writeByte(20);
            //buffer.write(1);
            //buffer.write(259);
            
            //buffer.flush();            
           
            //console.log(buffer.asBinaryString());
            //console.log(buffer.asHexString());
            
            //buffer.seek(0);
            
            //buffer.read(8);
            
            var num = 5;
            
            //console.log((num).toString(2), buffer.reverse(num).toString(2));                                                            
            
            
            var file = new ejs.zip.ZipFile();
            
            buffer.writeString('Wikipedia');
            console.log(buffer);
            
            //console.log(file.crc32(buffer.buffer));
            
            file.addFile('example.txt', 'This is some example text');
            file.addFile('moo/display.txt', 'Part two of the data');
            file.addFile('moo/cow/why would you say that.txt', 'Part two of the data');
            
            var test = 'This is some example text';
            
            var crc = file.crc32(test);
            var adler = file.adler32(test);
            
            var blahHex = 'edc4210100300800b02a4f408a170185a0bf26056e13fb93fd4a92244992244992244992a4ab6201';
            
            var blahBs = new ejs.zip.BitStream();
            blahBs.writeHexString(blahHex);
            console.log(new Uint8Array(blahBs.buffer));
            
            blahBs.position = 0;
            
            var deflater = new ejs.zip.Deflate();
            deflater.inflate(blahBs);
                                 
             
            
            //file.save();
            //file.save();
            

        
        </script>
    </head>
    <body>
        <div id="output"></div>
    </body>
</html>
