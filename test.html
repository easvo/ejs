<html>
    <head>
        <script type="text/javascript" src="bin/ejs.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.16/d3.js"></script>
        <script>
        //console.log("hello");
            var doc = new ejs.xml.XmlDocument();
            doc.root = new ejs.xml.XmlNode('a:aria', [{name : 'help', value : 'never another'}]);
            var node = new ejs.xml.XmlNode('help', [{name : 'haha', value : 'sure'}]);
            doc.root.nodes.push(node);
            
            //console.log(doc);
            
            //console.log(doc.write({pretty: true}), doc.toBinary());
            
            //var workbook = new ejs.xl.Workbook();
            
            //console.log(workbook.writeXml());
            
            var test = 'abbabbaaabababaaaaabbabaa';
            //var test = "Blahblahblahblahblahblahblah";
            test = 'Absolutely, The Good Wife is the best show in television to date, and if I dare say it, in forever.';
            
            var lz = new ejs.zip.LZ77();
            //var lzw = new ejs.zip.LZW();
            //console.log('input', test);
            //console.log('output', lz.compress(test));
            
            var data = new ArrayBuffer(8);
            var view = new Uint8Array(data);
            view[0] = 255;
            view[1] = 150;
            view[2] = 255;
            
            //ejs.helper.saveText('Never.txt', 'This is what happens');
            
            window.onload = function(){
                var huff = new ejs.zip.Huffman(test);
                var op = d3.select('#output');
                var codeElements = op.selectAll('div.codes').data(huff.codes);
                codeElements.enter().append('div').attr('class', 'codes');
                
                //console.log(huff);
                codeElements.text(function(d){
                    return d.code + ' - ' + d.bs;
                });
            }
            
            var buffer = new ejs.zip.BitStream();
            
            
            val = 14500;
            var a = 5;
            var needed = 5;
            var b = a << needed;
            var fromB = val >> (14 - needed);
            b |= fromB;
            
            var remaining = val << needed;
            
            var mask = 0;
            
            var left = 14 - needed;
            
            while (needed--){
                mask <<= 1;
                mask |= 1;
            }
            
            mask <<= left;
            
            // Clear bits
            //console.log(val & ~mask);
            
            //console.log(mask.toString(2), mask);
            
            
            
            //console.log(a.toString(2), b.toString(2));
            
            
            //buffer.writeByte(15);
            //buffer.writeByte(32);
            
            buffer.write(50);
            console.log(buffer);
            buffer.flush();
            //buffer.writeByte(20);
            //buffer.write(1);
            //buffer.write(259);
            
            buffer.flush();            
           
            console.log(buffer.asBinaryString());
            
            buffer.seek(0);
            
            buffer.read(6);
            
            var num = 5;
            
            console.log((num).toString(2), buffer.reverse(num).toString(2));
                        
            
            
            
            
            
            //var file = new ejs.zip.ZipFile();
            //file.save();
            

        
        </script>
    </head>
    <body>
        <div id="output"></div>
    </body>
</html>
